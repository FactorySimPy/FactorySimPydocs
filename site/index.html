
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://factorysimpy.github.io/FactorySimPydocs/">
      
      
      
        <link rel="next" href="reservablepriorityreqstore/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Extended Resources for FactorySimPy</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#extended-resources-for-factorysimpy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Extended Resources for FactorySimPy" class="md-header__button md-logo" aria-label="Extended Resources for FactorySimPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Extended Resources for FactorySimPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="reservablepriorityreqstore/" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Extended Resources for FactorySimPy" class="md-nav__button md-logo" aria-label="Extended Resources for FactorySimPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Extended Resources for FactorySimPy
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reservablepriorityreqstore" class="md-nav__link">
    <span class="md-ellipsis">
      ReservablePriorityReqStore
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReservablePriorityReqStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usecase" class="md-nav__link">
    <span class="md-ellipsis">
      Usecase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#priorityreqstore" class="md-nav__link">
    <span class="md-ellipsis">
      PriorityReqStore
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PriorityReqStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output_2" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usecase_1" class="md-nav__link">
    <span class="md-ellipsis">
      Usecase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output_3" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reservablepriorityreqstore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReservablePriorityReqStore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="priorityreqstore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PriorityReqStore
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reservablepriorityreqstore" class="md-nav__link">
    <span class="md-ellipsis">
      ReservablePriorityReqStore
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReservablePriorityReqStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usecase" class="md-nav__link">
    <span class="md-ellipsis">
      Usecase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#priorityreqstore" class="md-nav__link">
    <span class="md-ellipsis">
      PriorityReqStore
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PriorityReqStore">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-usage_1" class="md-nav__link">
    <span class="md-ellipsis">
      Example Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output_2" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usecase_1" class="md-nav__link">
    <span class="md-ellipsis">
      Usecase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-output_3" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="extended-resources-for-factorysimpy">Extended resources for FactorySimPy<a class="headerlink" href="#extended-resources-for-factorysimpy" title="Permanent link">&para;</a></h1>
<p>Welcome to the extended resources documentation for FactorySimPy!</p>
<hr />
<h3 id="reservablepriorityreqstore">ReservablePriorityReqStore<a class="headerlink" href="#reservablepriorityreqstore" title="Permanent link">&para;</a></h3>
<p>The ReservablePriorityReqStore is a class derived from SimPy's Store class that addresses a missing capability in the library by allowing both priority-based retrieval and reservation of items(or space) before they are actually retrieved (or put), respecting the capacity of the store. This is particularly useful in manufacturing systems where materials or products must be allocated in advance, ensuring that specific parts are reserved for machines before processing begins. It also allows priority-based retrieval, ensuring that urgent requests are handled first. Additionally, decoupling reservation from yielding a "get" request ensures that items remain in storage until they are actually needed, improving coordination in assembly lines and buffer management. Unlike SimPy’s existing resource reservation methods, which manage process-related elements like machines or operators, ReservablePriorityReqStore focuses on item-level management, making it a valuable addition for handling inventory, buffer stocks, and material flows in discrete-event simulations.
However, when implementhing SimPy interrupts, the events should be manually cancelled incase of an interruption.</p>
<p>The <code>ReservablePriorityReqStore</code> extends SimPy's <code>Store</code> by allowing users to:<br />
- <strong>Reserve Capacity</strong>: Processes can reserve space (or item) in the store before actual put (or get) in it.<br />
- <strong>Enforce Reservation Rules</strong>: Prohibits any process from adding (or getting) items to the store without a prior reservation.<br />
- <strong>Priority for requests</strong>: Users can pass a priority along with the reservation requests. The requests with the highest priority(lowest first) will be yielded first. Two requests with same priority will be yielded in a FIFO manner
- <strong>Cancel a reservation</strong>: Allows users to cancel a placed/yielded reserve_put (or reserve_get) request.</p>
<h5 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h5>
<ul>
<li><strong><code>env</code></strong>: The SimPy environment managing the simulation.  </li>
<li><strong><code>capacity</code></strong>: Maximum number of items the store can hold (default: infinite).  </li>
</ul>
<h5 id="example-usage">Example Usage<a class="headerlink" href="#example-usage" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">simpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ReservablePriorityReqStore</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReservablePriorityReqStore</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Item</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an item to be stored.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<span class="c1"># Simulation Setup</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">()</span>
<span class="n">itemstore</span> <span class="o">=</span> <span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">producer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">priority</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Producer process that reserves space, puts an item, and handles priority.&quot;&quot;&quot;</span>
    <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># Simulate time before producing</span>

    <span class="n">put_reservation</span> <span class="o">=</span> <span class="n">itemstore</span><span class="o">.</span><span class="n">reserve_put</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">put_reservation</span>  <span class="c1"># Wait for reservation to succeed</span>

    <span class="n">item</span> <span class="o">=</span> <span class="n">Item</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">itemstore</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">put_reservation</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> added to store with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">consumer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">priority</span><span class="p">,</span> <span class="n">cancel</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Consumer process that reserves an item, retrieves it, and optionally cancels.&quot;&quot;&quot;</span>
    <span class="c1">#yield env.timeout(random.uniform(2, 5))  # Simulate time before consuming</span>

    <span class="n">get_reservation</span> <span class="o">=</span> <span class="n">itemstore</span><span class="o">.</span><span class="n">reserve_get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> placed a reserve_get request to store with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cancel</span> <span class="ow">and</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]):</span>
        <span class="n">itemstore</span><span class="o">.</span><span class="n">reserve_get_cancel</span><span class="p">(</span><span class="n">get_reservation</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> CANCELED reservation&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">yield</span> <span class="n">get_reservation</span>  <span class="c1"># Wait for reservation to succeed</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> yielded from store with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">itemstore</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_reservation</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> retrieved </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> from store with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Creating producers and consumers</span>
<span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">consumer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="s2">&quot;Consumer1&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">cancel</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">consumer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="s2">&quot;Consumer2&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">consumer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="s2">&quot;Consumer3&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>


<span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">producer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="s2">&quot;ItemA&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">producer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="s2">&quot;ItemB&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">producer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">itemstore</span><span class="p">,</span> <span class="s2">&quot;ItemC&quot;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>


<span class="n">env</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<h5 id="simulation-output">Simulation output<a class="headerlink" href="#simulation-output" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>T=0.00 : Consumer1 placed a reserve_get request to store with priority 3
T=0.00 : Consumer1 CANCELED reservation
T=0.00 : Consumer2 placed a reserve_get request to store with priority 1
T=0.00 : Consumer3 placed a reserve_get request to store with priority 2
T=2.14 : ItemB added to store with priority 1
T=2.14 : Consumer2 yielded from store with priority 1
T=2.23 : ItemA added to store with priority 2
T=2.23 : Consumer3 yielded from store with priority 2
T=2.54 : ItemC added to store with priority 3
T=5.40 : Consumer2 retrieved ItemB from store with priority 1
T=6.02 : Consumer3 retrieved ItemA from store with priority 2 
</code></pre></div>
<h5 id="usecase">Usecase<a class="headerlink" href="#usecase" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code><span class="c1"># @title Usecase</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">simpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ReservablePriorityReqStore</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReservablePriorityReqStore</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">In this simulation, two machines (MachineGreen and MachineOrange) produce</span>
<span class="sd">new items by consuming specific part. MachineGreen,which produces green balls, </span>
<span class="sd">requests parts (like yellow and blue balls) with a higher priority, while </span>
<span class="sd">MachineOrange, which produces orange balls, requests parts</span>
<span class="sd">(like yellow and red balls) with lower priority. Producers generate red, yellow, </span>
<span class="sd">and blue balls at defined intervals, and consumers retrieve the assembled green </span>
<span class="sd">and orange balls from their respective stores.&#39;&#39;&#39;</span>



<span class="c1"># ----- Producer -----</span>
<span class="k">def</span><span class="w"> </span><span class="nf">producer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">interarrival</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">item_prefix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produces items with a given prefix into a store.&quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">interarrival</span><span class="p">)</span>
        <span class="n">put_req</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">reserve_put</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">put_req</span>
        <span class="n">item_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item_prefix</span><span class="si">}{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">put_req</span><span class="p">,</span> <span class="n">item_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Producer </span><span class="si">{</span><span class="n">item_prefix</span><span class="si">}</span><span class="s2">: added </span><span class="si">{</span><span class="n">item_name</span><span class="si">}</span><span class="s2"> (store size=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># ----- Consumer -----</span>
<span class="k">def</span><span class="w"> </span><span class="nf">consumer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">interarrival</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">consumer_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Consumes items from a store.&quot;&quot;&quot;</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">interarrival</span><span class="p">)</span>
        <span class="n">get_req</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">reserve_get</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">get_req</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">get_req</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Consumer </span><span class="si">{</span><span class="n">consumer_name</span><span class="si">}</span><span class="s2">: got item </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># ----- Machine -----</span>
<span class="k">def</span><span class="w"> </span><span class="nf">machine</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">input_stores</span><span class="p">,</span> <span class="n">input_priorities</span><span class="p">,</span> <span class="n">output_store</span><span class="p">,</span> <span class="n">output_prefix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A machine that requests multiple items from input stores (with optional priorities),</span>
<span class="sd">    waits processing time, and outputs a new item.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_stores (list): list of stores to get inputs from</span>
<span class="sd">        input_priorities (list): list of priorities (None if no priority)</span>
<span class="sd">        output_store: where to put output</span>
<span class="sd">        output_prefix: name prefix for output items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">put_req</span> <span class="o">=</span> <span class="n">output_store</span><span class="o">.</span><span class="n">reserve_put</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">put_req</span>

        <span class="c1"># Request input items</span>
        <span class="n">input_requests</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">store</span><span class="p">,</span> <span class="n">priority</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">input_stores</span><span class="p">,</span> <span class="n">input_priorities</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">priority</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">req</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">reserve_get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">req</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">reserve_get</span><span class="p">()</span>
            <span class="n">input_requests</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Machine </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">: waiting to yield reserve_get requests&quot;</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">all_of</span><span class="p">(</span><span class="n">input_requests</span><span class="p">)</span>

        <span class="c1"># Get input items</span>
        <span class="k">for</span> <span class="n">store</span><span class="p">,</span> <span class="n">req</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">input_stores</span><span class="p">,</span> <span class="n">input_requests</span><span class="p">):</span>
            <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Machine </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">: got both inputs&quot;</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>

        <span class="n">output_store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">put_req</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: Machine </span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">: finished product is available in its store&quot;</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># ----- Simulation Setup -----</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_simulation</span><span class="p">():</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">()</span>

    <span class="c1"># Create Stores</span>
    <span class="n">redstore</span> <span class="o">=</span> <span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">yellowstore</span> <span class="o">=</span> <span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">bluestore</span> <span class="o">=</span> <span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">orangestore</span> <span class="o">=</span> <span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">greenstore</span> <span class="o">=</span> <span class="n">ReservablePriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Producer setups</span>
    <span class="n">producer_params</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">redstore</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">yellowstore</span><span class="p">,</span> <span class="s2">&quot;yellow&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bluestore</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Consumer setups</span>
    <span class="n">consumer_params</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">orangestore</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">greenstore</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Machine setups</span>
    <span class="n">machine_params</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">yellowstore</span><span class="p">,</span> <span class="n">redstore</span><span class="p">],</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">orangestore</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">),</span>  <span class="c1"># Machine1</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">yellowstore</span><span class="p">,</span> <span class="n">bluestore</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">greenstore</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">)</span>      <span class="c1"># Machine2</span>
    <span class="p">]</span>

    <span class="c1"># Start Producers</span>
    <span class="k">for</span> <span class="n">interarrival</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">producer_params</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">producer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">interarrival</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">prefix</span><span class="p">))</span>

    <span class="c1"># Start Consumers</span>
    <span class="k">for</span> <span class="n">interarrival</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">consumer_params</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">consumer</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">interarrival</span><span class="p">,</span> <span class="n">store</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

    <span class="c1"># Start Machines</span>
    <span class="k">for</span> <span class="n">delay</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">priorities</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">machine_params</span><span class="p">:</span>
        <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">machine</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">priorities</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">prefix</span><span class="p">))</span>

    <span class="c1"># Run Simulation</span>
    <span class="n">env</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>



<span class="c1"># Run it</span>
<span class="n">run_simulation</span><span class="p">()</span>
</code></pre></div>
<h5 id="simulation-output_1">Simulation output<a class="headerlink" href="#simulation-output_1" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>T=0.00: Machine orange: waiting to yield reserve_get requests
T=0.00: Machine green: waiting to yield reserve_get requests
T=1.00: Producer red: added red1 (store size=1)
T=1.00: Producer blue: added blue1 (store size=1)
T=2.00: Producer yellow: added yellow1 (store size=1)
T=2.00: Producer red: added red2 (store size=2)
T=2.00: Producer blue: added blue2 (store size=2)
T=2.00: Machine green: got both inputs
T=3.00: Machine green: finished product is available in its store
T=3.00: Producer red: added red3 (store size=3)
T=3.00: Producer blue: added blue3 (store size=2)
T=3.00: Consumer green: got item green0
T=3.00: Machine green: waiting to yield reserve_get requests
T=4.00: Producer yellow: added yellow2 (store size=1)
T=4.00: Producer red: added red4 (store size=4)
T=4.00: Producer blue: added blue4 (store size=3)
T=4.00: Machine green: got both inputs
</code></pre></div>
<p><a href="reservablepriorityreqstore/">Go to API Reference</a></p>
<hr />
<h2 id="priorityreqstore">PriorityReqStore<a class="headerlink" href="#priorityreqstore" title="Permanent link">&para;</a></h2>
<p>PriorityReqStore is a resource store with basic priority handling capabilities. Users can add a priority for each of the get(or put) requests. Request with lower values of priority yields first. If two requests with same priority are placed from two processes then FIFO order is followed to yield the requests.</p>
<p><strong>Main Features:</strong>
- Manages multiple requests with different priorities.</p>
<h5 id="parameters_1">Parameters<a class="headerlink" href="#parameters_1" title="Permanent link">&para;</a></h5>
<ul>
<li><strong><code>env</code></strong>: The SimPy environment managing the simulation.  </li>
<li><strong><code>capacity</code></strong>: Maximum number of items the store can hold (default: infinite).  </li>
</ul>
<h3 id="example-usage_1">Example Usage<a class="headerlink" href="#example-usage_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">simpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PriorityReqStore</span><span class="w"> </span><span class="kn">import</span> <span class="n">PriorityReqStore</span>

<span class="k">class</span><span class="w"> </span><span class="nc">item</span><span class="p">:</span>
  <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">name</span>

<span class="k">def</span><span class="w"> </span><span class="nf">source</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">delay</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">1</span>

    <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="n">item1</span> <span class="o">=</span> <span class="n">item</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;item&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">: Source </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Going to put an item in store </span><span class="si">{</span><span class="n">item1</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">yield</span> <span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">item1</span><span class="p">,</span><span class="n">priority</span><span class="p">)</span>


    <span class="c1">#print(f&#39;T={env.now:.2f}: Source {name} is putting an item in store {item1.name} with priority {priority}&#39;)</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">2</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sink</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="n">delay</span><span class="p">,</span><span class="n">priority</span><span class="p">):</span>

    <span class="k">yield</span> <span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">: Sink </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> placed a get request with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s1"> in the store&#39;</span><span class="p">)</span>
    <span class="n">item</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">priority</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;T=</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">: Sink </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> Got an item from store </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#p5= env.process(source(&#39;IN-A&#39;,env,1))</span>
<span class="c1">#p6= env.process(source(&#39;IN-B&#39;,env,1))</span>


<span class="n">env</span><span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">()</span>
<span class="n">store</span><span class="o">=</span> <span class="n">PriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">p1</span><span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">sink</span><span class="p">(</span><span class="s1">&#39;OUT-1&#39;</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">p2</span><span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">sink</span><span class="p">(</span><span class="s1">&#39;OUT-2&#39;</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">p3</span><span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">source</span><span class="p">(</span><span class="s1">&#39;IN-A&#39;</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">p4</span><span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">source</span><span class="p">(</span><span class="s1">&#39;IN-B&#39;</span><span class="p">,</span><span class="n">env</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="n">env</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<h3 id="simulation-output_2">Simulation output<a class="headerlink" href="#simulation-output_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>T=0.00: Sink OUT-1 placed a get request with priority 2 in the store
T=0.00: Sink OUT-2 placed a get request with priority 1 in the store
T=1.00: Source IN-A Going to put an item in store itemIN-A1 with priority 2
T=1.00: Source IN-B Going to put an item in store itemIN-B1 with priority 1
T=1.00: Sink OUT-2 Got an item from store itemIN-A1
T=1.00: Sink OUT-1 Got an item from store itemIN-B1
</code></pre></div>
<h3 id="usecase_1">Usecase<a class="headerlink" href="#usecase_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">A university’s Central IT Department supports Admin, Library, Student Labs,</span>
<span class="sd">and Research Labs. Departments request IT systems (computers). Systems are</span>
<span class="sd">allocated based on request priority — higher-priority departments get</span>
<span class="sd">systems first.&#39;&#39;&#39;</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">simpy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PriorityReqStore</span><span class="w"> </span><span class="kn">import</span> <span class="n">PriorityReqStore</span>  <span class="c1"># Importing your PriorityReqStore</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CentralITDepartment</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">initial_stock</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store</span> <span class="o">=</span> <span class="n">PriorityReqStore</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Pre-load some stock if needed</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_stock</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Preloaded_System_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">department_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">department_name</span><span class="p">,</span> <span class="n">priority</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Department places a request for a system.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">department_name</span><span class="si">}</span><span class="s2"> places a request with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">system</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">department_name</span><span class="p">,</span> <span class="n">system</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">department_name</span><span class="si">}</span><span class="s2"> received </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_systems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;IT department adds systems after a delay.&quot;&quot;&quot;</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
            <span class="n">system_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;System_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">_after_delay&quot;</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">system_name</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">now</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: IT Department added </span><span class="si">{</span><span class="n">system_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_central_it_simulation</span><span class="p">():</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">simpy</span><span class="o">.</span><span class="n">Environment</span><span class="p">()</span>
    <span class="n">it_department</span> <span class="o">=</span> <span class="n">CentralITDepartment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

    <span class="c1"># Start departments making requests</span>
    <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">it_department</span><span class="o">.</span><span class="n">department_request</span><span class="p">(</span><span class="s1">&#39;Admin&#39;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">it_department</span><span class="o">.</span><span class="n">department_request</span><span class="p">(</span><span class="s1">&#39;Library&#39;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">it_department</span><span class="o">.</span><span class="n">department_request</span><span class="p">(</span><span class="s1">&#39;Student Lab&#39;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">it_department</span><span class="o">.</span><span class="n">department_request</span><span class="p">(</span><span class="s1">&#39;Research Lab&#39;</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># IT Department will add new systems after 2 time units</span>
    <span class="n">env</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">it_department</span><span class="o">.</span><span class="n">add_systems</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">env</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">until</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">run_central_it_simulation</span><span class="p">()</span>
</code></pre></div>
<h3 id="simulation-output_3">Simulation output<a class="headerlink" href="#simulation-output_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>T=0.00: Admin places a request with priority 3
T=0.00: Library places a request with priority 3
T=0.00: Student Lab places a request with priority 1
T=0.00: Research Lab places a request with priority 2
T=2.00: IT Department added System_1_after_delay
T=2.00: Student Lab received System_1_after_delay
T=2.00: IT Department added System_2_after_delay
T=2.00: Research Lab received System_2_after_delay
T=2.00: IT Department added System_3_after_delay
T=2.00: Admin received System_3_after_delay
</code></pre></div>
<p><a href="priorityreqstore/">Go to API Reference</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tabs", "navigation.sections"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>